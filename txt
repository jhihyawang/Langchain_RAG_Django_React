# 若 x2、y2 剛好等於邊界，容易造成寬/高=0，再保證各 >0
if x2 - x1 < 2 or y2 - y1 < 2:           # 2 px 為下限，可依需求調
    return {"page": page_num,
            "media_type": "table",
            "source": None,
            "content": "❌ 表格範圍異常，已跳過"}      # 直接略過這張表
tbl_crop = img.crop((x1, y1, x2, y2))
