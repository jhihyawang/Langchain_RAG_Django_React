    def post(self, request, *args, **kwargs):
        # 1. 驗證上傳檔案
        if "file" not in request.FILES:
            return Response({"success": False, "message": "請上傳文件"}, status=status.HTTP_400_BAD_REQUEST)
        file = request.FILES["file"]
        if not file.name.lower().endswith(".pdf"):
            return Response({"success": False, "message": "只允許上傳 PDF"}, status=status.HTTP_400_BAD_REQUEST)

        # 2. 建立 Knowledge (processing_status 會預設為 'pending')
        department = request.data.get("department", "")
        author_id  = request.data.get("author", None)
        knowledge = Knowledge.objects.create(
            file=file,
            department=department,
            author_id=author_id,
            title=os.path.splitext(file.name)[0],
            processing_status="pending"
        )

        # 3. 只為這一筆建立背景任務
        process_pdf_background(knowledge.id)

        # 4. 回傳
        return Response({
            "success": True,
            "message": "檔案已上傳，背景處理中",
            "data": KnowledgeSerializer(knowledge).data
        }, status=status.HTTP_200_OK)
