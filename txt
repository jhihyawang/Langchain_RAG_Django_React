def cleanup_page_resources(self, local_vars: dict):
    import gc
    import torch
    from PIL import Image

    keys_to_delete = ["conv_res", "page", "image", "summary", "element", "element_image_filename", "df", "sentences"]
    for k in keys_to_delete:
        if k in local_vars:
            val = local_vars[k]
            try:
                if isinstance(val, Image.Image):
                    val.close()
                del val
            except Exception as e:
                print(f"âš ï¸ ç„¡æ³•æ¸…é™¤è®Šæ•¸ {k}: {e}")

    gc.collect()  # ğŸ”„ é‡‹æ”¾ Python è¨˜æ†¶é«”

    # ğŸ§  é‡‹æ”¾ CUDA/GPU è¨˜æ†¶é«”
    if torch.cuda.is_available():
        torch.cuda.empty_cache()
        torch.cuda.ipc_collect()
