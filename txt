def correction_direction(self):
    log(f"📝 檢查是否需要旋轉：{self.knowledge_title}...")

    # 一次性開啟文件
    with pdfplumber.open(self.pdf_path) as pdf:
        table_pages = [i + 1 for i, p in enumerate(pdf.pages) if p.extract_tables()]

    # 集中式開啟 fitz
    doc = fitz.open(self.pdf_path)
    rotated_pages = []

    for i in table_pages:
        log(f"🔍 第 {i} 頁處理中...")

        # 僅此處產生圖像（避免無意義的全部轉換）
        page = doc.load_page(i - 1)
        pix = page.get_pixmap(dpi=200)
        img = Image.frombytes("RGB", [pix.width, pix.height], pix.samples)

        # OCR 偵測旋轉角度
        ocr_result = self.reader.readtext(np.array(img))
        angle = self.detect_rotation_angle_easyocr(ocr_result)

        if angle == 90:
            rotated_pages.append(i)
            log(f"➡️ 第 {i} 頁需旋轉 90 度")

    doc.close()
    return rotated_pages
